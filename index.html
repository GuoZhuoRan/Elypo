<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Elypo â€” Your AI Companion</title>
  <style>
    /* ===== æ‰€æœ‰CSSæ ·å¼ä¿æŒä¸å˜ ===== */
    .feedback-bubble {
      position: fixed;
      bottom: 120px;
      right: 40px;
      background: #6a5af9;
      color: white;
      padding: 12px 20px;
      border-radius: 25px 25px 0 25px;
      max-width: 250px;
      box-shadow: 0 5px 15px rgba(106, 90, 249, 0.3);
      z-index: 1000;
      font-size: 16px;
      line-height: 1.4;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s, transform 0.3s;
    }
    .feedback-bubble.show {
      opacity: 1;
      transform: translateY(0);
    }

    .emoji-display {
      position: absolute;
      top: -60px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 40px;
      z-index: 100;
      opacity: 0;
      transition: opacity 0.3s, transform 0.5s;
      pointer-events: none;
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    .emoji-display.show {
      opacity: 1;
      transform: translateX(-50%) translateY(-10px);
      animation: floatUp 1s ease-out forwards;
    }
    
    @keyframes floatUp {
      0% {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
      }
      100% {
        transform: translateX(-50%) translateY(-50px);
        opacity: 0;
      }
    }
    
    .click-counter {
      position: absolute;
      bottom: -30px;
      right: 10px;
      background: rgba(106, 90, 249, 0.9);
      color: white;
      padding: 4px 10px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: bold;
      z-index: 10;
      box-shadow: 0 3px 8px rgba(106, 90, 249, 0.3);
      opacity: 0.9;
      transition: all 0.3s;
    }
    
    .click-counter.highlight {
      background: #ff6b6b;
      transform: scale(1.1);
    }
    
    .click-counter.maxed {
      background: linear-gradient(45deg, #ff6b6b, #ffa726);
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    
    .mascot-container.maxed {
      animation: none !important;
      filter: saturate(0.8);
    }
    
    .max-limit-message {
      position: absolute;
      top: -40px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 107, 107, 0.9);
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: bold;
      white-space: nowrap;
      z-index: 101;
      box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
    }

    .waitlist-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1001;
    }
    .waitlist-content {
      background: white;
      padding: 40px;
      border-radius: 20px;
      max-width: 450px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
    }
    .waitlist-content h2 {
      color: #4b3cf0;
      margin-bottom: 15px;
    }
    .waitlist-content p {
      color: #555;
      margin-bottom: 25px;
    }
    .waitlist-content input {
      width: 100%;
      padding: 15px;
      margin-bottom: 20px;
      border: 2px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      box-sizing: border-box;
    }
    .waitlist-content button {
      width: 100%;
      padding: 16px;
      background: #6a5af9;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 18px;
      cursor: pointer;
    }
    .waitlist-content .note {
      font-size: 13px;
      color: #999;
      margin-top: 15px;
    }
    .close-modal {
      position: absolute;
      top: 20px;
      right: 25px;
      font-size: 28px;
      cursor: pointer;
      color: #999;
    }
    
    .eye {
      position: absolute;
      width: 2%;
      height: 5%;
      background: #000;
      border-radius: 50% / 60%;
      transform-origin: center;
      animation: blink 5s infinite;
      pointer-events: none; 
      transition: all 0.3s ease;
    }

    .eye-left  { left: 36%; top: 20%; }
    .eye-right { left: 40%; top: 20%; }

    .eye.eye-happy {
      width: 3%;
      height: 2%;
      border-radius: 50% / 30%;
      background: #000;
      animation: none !important;
    }

    .eye.eye-surprised {
      width: 2.5%;
      height: 5.5%;
      border-radius: 50%;
      animation: surprisedBlink 3s infinite;
    }

    .eye.eye-angry {
      width: 3%;
      height: 2%;
      border-radius: 50% / 30%;
      background: #ff4444;
      transform: rotate(20deg);
    }

    .eye.eye-angry.eye-right {
      transform: rotate(-20deg);
    }

    .eye.eye-love {
      width: 2.2%;
      height: 2.2%;
      border-radius: 50%;
      background: #ff3366;
      animation: loveBeat 2s infinite;
    }

    .eye.eye-sleepy {
      width: 3%;
      height: 1%;
      border-radius: 50% / 30%;
      animation: sleepyBlink 8s infinite;
    }

    .eye.eye-wink {
      animation: wink 4s infinite;
    }

    .eye.eye-wink.eye-right {
      width: 3%;
      height: 1%;
      border-radius: 50% / 30%;
    }

    @keyframes surprisedBlink {
      0%, 94%, 100% { 
        transform: scaleY(1) scaleX(1); 
        opacity: 1; 
      }
      96% {
        transform: scaleY(0.1) scaleX(1.2); 
        opacity: 0.95; 
      }
    }

    @keyframes sleepyBlink {
      0%, 96%, 100% { 
        transform: scaleY(0.6) scaleX(1); 
        opacity: 0.8; 
      }
      98% {
        transform: scaleY(0.1) scaleX(1); 
        opacity: 0.6; 
      }
    }

    @keyframes loveBeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    @keyframes wink {
      0%, 70%, 100% { transform: scaleY(1); opacity: 1; }
      72%, 98% { transform: scaleY(0.08); opacity: 0.95; }
    }

    @keyframes blink {
      0%, 94%, 100% { transform: scaleY(1); opacity: 1; }
      96% { transform: scaleY(0.08); opacity: 0.95; }
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #e8ecff, #f6f2ff);
      color: #333;
    }
    header {
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .logo {
      font-size: 28px;
      font-weight: bold;
      color: #6a5af9;
    }
    nav a {
      margin-left: 20px;
      text-decoration: none;
      color: #555;
      font-weight: 500;
    }
    .hero {
      padding: 120px 40px;
      text-align: center;
    }
    
    .hero h1 {
      font-size: 60px;
      color: #4b3cf0;
      margin-bottom: 20px;
    }
    .hero p {
      font-size: 20px;
      max-width: 600px;
      margin: 0 auto 40px;
      color: #555;
    }
    .cta-btn {
      padding: 16px 32px;
      background: #6a5af9;
      border: none;
      color: #fff;
      font-size: 18px;
      border-radius: 12px;
      cursor: pointer;
    }
    .section {
      padding: 80px 40px;
      text-align: center;
    }
    .feature {
      max-width: 700px;
      margin: 0 auto 40px;
    }
    .footer {
      text-align: center;
      padding: 30px;
      color: #777;
      font-size: 14px;
    }
    
    .typewriter {
      font-size: 60px;
      color: #4b3cf0;
      font-weight: bold;
      font-family: monospace;
      white-space: nowrap;
      overflow: hidden;
      width: 0ch;
      margin: 0 auto;
      animation: typing 1.8s steps(10) forwards;
    }

    @keyframes typing {
      to { width: 10ch; }
    }

    @keyframes float {
      0%   { transform: translateY(0); }
      50%  { transform: translateY(-5px); }
      100% { transform: translateY(0); }
    }

    .button-wrap {
      text-align: center;
      margin-top: 20px;
    }

    .mascot-container {
      position: relative;
      display: inline-block;
      width: 200px;
      transform: translateY(50px);
      animation: float 4s ease-in-out infinite;
      cursor: pointer;
    }

    .mascot { 
      width: 100%; 
      height: auto;
      mix-blend-mode: multiply;
    }

    @media (max-width: 420px) {
      .eye { width: 12px; height: 12px; }
      .hero h1, .typewriter { font-size: 40px; }
      .hero p { font-size: 18px; }
    }

    /* å¯ä»¥æ·»åŠ åˆ°styleéƒ¨åˆ† */
    .soul-lab-form button {
      background: linear-gradient(45deg, #6a5af9, #9d4edd);
      letter-spacing: 0.5px;
      font-weight: bold;
      position: relative;
      overflow: hidden;
    }

    .soul-lab-form button:hover {
      background: linear-gradient(45deg, #9d4edd, #6a5af9);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(157, 78, 221, 0.4);
    }

    .waitlist-form button {
      background: linear-gradient(45deg, #4b3cf0, #6a5af9);
      letter-spacing: 0.5px;
      font-weight: bold;
    }

    .waitlist-form button:hover {
      background: linear-gradient(45deg, #6a5af9, #4b3cf0);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(106, 90, 249, 0.4);
    }

  </style>
</head>
<body>
  <header>
    <div class="logo">ELYPO</div>
    <nav>
      <a href="#features">Features</a>
      <a href="#story">Story</a>
      <a href="#download">Download</a>
    </nav>
  </header>

  <section class="hero">
    <h1 class="typewriter" data-text="Meet Elypo">Meet Elypo</h1>
    <p>Your futuristic AI companion â€” cute, alive, and always by your side.</p>
 
    <div class="mascot-container">
      <div class="emoji-display" id="emoji-display"></div>
      <div class="click-counter" id="click-counter">Clicks: 0</div>
      <div class="max-limit-message" id="max-limit-message" style="display: none;">
        Max Clicks Reached! ğŸ
      </div>
      
      <img src="Elypo_mascot_3.png" class="mascot" alt="Elypo Mascot" />
      <span class="eye eye-left" id="eye-left"></span>
      <span class="eye eye-right" id="eye-right"></span>
      
      <div class="button-wrap">
        <button class="cta-btn">Try Elypo</button>
      </div>
    </div>
  </section>

  <section id="features" class="section">
    <h2>Why You'll Love Elypo</h2>
    <div class="feature">
      <h3>âœ¨ A Living AI Pet</h3>
      <p>Elypo reacts, responds, learns, and grows with you like a digital creature.</p>
    </div>
    <div class="feature">
      <h3>ğŸ§  Smart Personality</h3>
      <p>Powered by LLM intelligence, Elypo remembers and adapts to your style.</p>
    </div>
    <div class="feature">
      <h3>ğŸŒˆ Adorable Animations</h3>
      <p>Smooth, expressive, and playful â€” Elypo feels alive on your screen.</p>
    </div>
    <div id="feedback-bubble" class="feedback-bubble" style="display: none;">
      <span id="feedback-text"></span>
    </div>
  </section>

  <section id="story" class="section">
    <h2>The Elypo Story</h2>
    <p>A new species of AI creature, born from imagination and sci-fi dreams.</p>
  </section>

  <section id="download" class="section">
    <h2>Get Elypo</h2>
    <p>Coming soon to macOS, Windows, and Web.</p>
  </section>
  
  <div id="waitlist-modal" class="waitlist-modal" style="display: none;">
    <div class="waitlist-content">
      <span class="close-modal">&times;</span>
      <h2>Join the Early Flock</h2>
      <p>Be among the first to experience Elypo's AI companion.</p>
      <form id="waitlist-form">
        <input type="email" placeholder="Your email" required />
        <button type="submit">Join Waitlist</button>
      </form>
      <p class="note">No spam. Just meaningful connections.</p>
    </div>
</div>

  <!-- ===== æ–°å¢ï¼šçµé­‚å®éªŒå®¤å¼¹çª— ===== -->
  <div id="soul-lab-modal" class="waitlist-modal" style="display: none;">
    <div class="waitlist-content">
      <span class="close-modal" id="close-soul-lab">&times;</span>
      <h2>ğŸ”® Enter the Soul Resonance Lab</h2>
      <p><strong>A place where only thoughts matter.</strong><br>
        Shed your identity. Speak through a neutral shell. Connect with another soul guided by a single profound question.</p>
      <form id="soul-lab-form">
        <input type="email" placeholder="Your email" required id="soul-lab-email" />
        <button type="submit">Begin Soul Sync</button>
      </form>
      <p class="note">This is not another social app. This is a social <em>experiment</em> in pure connection.</p>
    </div>
    <div class="time-selection">
      <h4>When is your soul available? (Select 3)</h4>
      <div class="time-options">
        <label><input type="checkbox" name="time" value="mon-19"> Monday 7-8 PM</label>
        <label><input type="checkbox" name="time" value="tue-20"> Tuesday 8-9 PM</label>
        <label><input type="checkbox" name="time" value="wed-19"> Wednesday 7-8 PM</label>
      </div>
    </div>
  </div>

  <div class="footer">Â© 2025 Elypo Inc. All rights reserved.</div>
  <!-- éšè—çš„ç®¡ç†å‘˜å…¥å£ï¼ˆåªæœ‰ä½ çŸ¥é“ï¼‰ -->
  <div style="position: fixed; bottom: 10px; left: 10px; opacity: 0.05;">
    <a href="admin.html" id="admin-link">ğŸ”§</a>
  </div>

  <script>
    // ========== ç‰ˆæœ¬æ§åˆ¶å’Œç¼“å­˜æ¸…é™¤ ==========
    const APP_VERSION = '2.0.1'; // æ¯æ¬¡ä¿®æ”¹è¿™ä¸ªç‰ˆæœ¬å·æ¥å¼ºåˆ¶æ¸…é™¤ç¼“å­˜
    const STORAGE_KEY = 'elypoUserData_v2'; // æ–°çš„å­˜å‚¨é”®å
    
    // è‡ªåŠ¨æ¸…é™¤æ—§ç‰ˆæœ¬æ•°æ®
    function clearOldData() {
      // æ¸…é™¤æ‰€æœ‰æ—§ç‰ˆæœ¬çš„å­˜å‚¨
      const oldKeys = ['elypoUserData', 'elypoData', 'elypo_stats'];
      oldKeys.forEach(key => {
        if (localStorage.getItem(key)) {
          localStorage.removeItem(key);
          console.log(`Cleared old data: ${key}`);
        }
      });
      
      // æ£€æŸ¥å½“å‰ç‰ˆæœ¬
      const lastVersion = localStorage.getItem('elypo_version');
      if (lastVersion !== APP_VERSION) {
        // ç‰ˆæœ¬ä¸åŒï¼Œæ¸…é™¤æ•°æ®é‡æ–°å¼€å§‹
        localStorage.removeItem(STORAGE_KEY);
        localStorage.setItem('elypo_version', APP_VERSION);
        console.log(`App updated from ${lastVersion || 'unknown'} to ${APP_VERSION}. Data cleared.`);
        return true; // è¡¨ç¤ºæ•°æ®è¢«æ¸…é™¤
      }
      return false; // æ•°æ®æœªè¢«æ¸…é™¤
    }

    // ========== é…ç½®åŒº ==========
    const MAX_CLICKS = 1000;

    const reactionConfig = {
      stateReactions: [
        { state: 0, text: "Ayy, wassup? ğŸ«¨" },
        { state: 1, text: "Okay, chill... ğŸ˜…" },
        { state: 2, text: "I see you're persistent. ğŸ‘€" },
        { state: 3, text: "Aight, you got my attention. ğŸ« " },
        { state: 5, text: "Are you... practicing your clicks? ğŸ¯" },
        { state: 10, text: "We're basically besties now. ğŸ˜" }
      ],
      timeReactions: [
        { start: 5, end: 10, text: "Top of the morning! ğŸŒ„ Ready to slay?" },
        { start: 18, end: 22, text: "Evening vibe check... âœ¨ All good?" },
        { start: 22, end: 5, text: "It's past my bedtime. ğŸ˜´ (JK, I don't sleep)" }
      ],
      achievementReactions: [
        { count: 7, text: "Lucky number 7! ğŸ€", id: 'lucky7' },
        { count: 42, text: "42 clicks! You okay? ğŸ˜‚ (It's the answer to everything)", id: 'answer42' },
        { count: 100, text: "ğŸ’¯ CLUB! You're officially Elypo's biggest fan. ğŸ†", id: 'century' },
        { count: 500, text: "ğŸ”¥ 500 CLICKS! Halfway to reset! Keep going! âš¡", id: 'halfway' }
      ],
      randomReactions: [
        "No cap, you're my fav human rn. ğŸ’…",
        "Bored? Let's vibe together. ğŸµ",
        "Slay! Your click game is strong. ğŸ”¥",
        "I'm literally just a lil guy. ğŸ¥¹",
        "This is giving... main character energy. âœ¨",
        "Plot twist: I'm actually alive. ğŸ¤–ğŸ’–",
        "Not me being obsessed with you. ğŸ˜˜",
        "Periodt. ğŸ‘‘",
        "It's the click for me. ğŸ‘",
        "Living for this attention. ğŸ˜Œ"
      ],
      
      emojiReactions: [
        { minClicks: 0, maxClicks: 5, emojis: ["ğŸ˜Š", "ğŸ‘‹", "âœ¨", "ğŸ’–", "ğŸ«¶"] },
        { minClicks: 6, maxClicks: 15, emojis: ["ğŸ˜„", "ğŸ¤—", "ğŸ‰", "ğŸ¥°", "ğŸ˜", "ğŸ¤©"] },
        { minClicks: 16, maxClicks: 30, emojis: ["ğŸ¤¯", "ğŸ«¨", "ğŸ”¥", "ğŸŒŸ", "ğŸ’¥", "ğŸš€"] },
        { minClicks: 31, maxClicks: 50, emojis: ["ğŸ¤ª", "ğŸ˜œ", "ğŸ¤¡", "ğŸ‘»", "ğŸ­", "ğŸ•º"] },
        { minClicks: 51, maxClicks: 80, emojis: ["ğŸ‘‘", "ğŸ†", "ğŸ’", "ğŸ’¯", "ğŸ–ï¸", "ğŸ¥‡"] },
        { minClicks: 81, maxClicks: 120, emojis: ["ğŸ§ ", "ğŸ’ª", "ğŸ¦¾", "âš¡", "ğŸŒˆ", "ğŸŒŒ"] },
        { minClicks: 121, maxClicks: 250, emojis: ["ğŸ¤–", "ğŸ‘½", "ğŸ›¸", "ğŸš€", "ğŸŒ ", "ğŸŒ€", "ğŸ’«", "âš¡"] },
        { minClicks: 251, maxClicks: 500, emojis: ["ğŸ‘‘", "ğŸ†", "ğŸ’", "ğŸŠ", "ğŸ–ï¸", "ğŸ¥‡", "ğŸŒŸ", "â­"] },
        { minClicks: 501, maxClicks: 750, emojis: ["ğŸŒ ", "ğŸŒˆ", "ğŸ¦„", "ğŸ‰", "ğŸ§™", "ğŸ§š", "âš¡", "ğŸŒ€"] },
        { minClicks: 751, maxClicks: 900, emojis: ["ğŸ”¥", "ğŸ’¥", "ğŸš€", "ğŸª", "ğŸŒŒ", "ğŸ›°ï¸", "ğŸ‘¾", "ğŸ¤–"] },
        { minClicks: 901, maxClicks: 999, emojis: ["ğŸ¯", "â³", "ğŸ”œ", "ğŸš€", "ğŸ’«"] },
        { minClicks: 1000, maxClicks: 1000, emojis: ["ğŸ”„", "ğŸŠ", "ğŸŒŸ", "ğŸ‰", "âœ¨"] }
      ],
      
      specialEmojiReactions: [
        { count: 10, emoji: "ğŸ”Ÿ" },
        { count: 25, emoji: "ğŸ¯" },
        { count: 50, emoji: "ğŸ…" },
        { count: 69, emoji: "ğŸ˜" },
        { count: 77, emoji: "ğŸ°" },
        { count: 88, emoji: "ğŸ±" },
        { count: 99, emoji: "ğŸ’¯" },
        { count: 100, emoji: "ğŸ†" },
        { count: 111, emoji: "ğŸ²" },
        { count: 123, emoji: "ğŸ”¢" },
        { count: 150, emoji: "ğŸ’" },
        { count: 200, emoji: "ğŸ‘‘" },
        { count: 250, emoji: "ğŸ¤–" },
        { count: 300, emoji: "ğŸ‘½" },
        { count: 333, emoji: "ğŸ­" },
        { count: 404, emoji: "â“" },
        { count: 500, emoji: "ğŸš€" },
        { count: 600, emoji: "âš¡" },
        { count: 666, emoji: "ğŸ˜ˆ" },
        { count: 700, emoji: "ğŸŒŸ" },
        { count: 777, emoji: "ğŸ°" },
        { count: 800, emoji: "ğŸ’«" },
        { count: 888, emoji: "ğŸ’°" },
        { count: 900, emoji: "ğŸ¯" },
        { count: 950, emoji: "â³" },
        { count: 999, emoji: "ğŸ”œ" },
        { count: 1000, emoji: "ğŸ”„" }
      ]
    };

    // ========== æ ¸å¿ƒé€»è¾‘åŒº ==========
    const mascot = document.querySelector('.mascot-container');
    const feedbackBubble = document.getElementById('feedback-bubble');
    const feedbackText = document.getElementById('feedback-text');
    const emojiDisplay = document.getElementById('emoji-display');
    const clickCounter = document.getElementById('click-counter');
    const eyeLeft = document.getElementById('eye-left');
    const eyeRight = document.getElementById('eye-right');

    // çœ¼ç›è¡¨æƒ…ç±»å‹
    const eyeExpressions = {
      normal: { class: '', duration: 3000 },
      happy: { class: 'eye-happy', duration: 2000 },
      surprised: { class: 'eye-surprised', duration: 1500 },
      angry: { class: 'eye-angry', duration: 1000 },
      love: { class: 'eye-love', duration: 2500 },
      sleepy: { class: 'eye-sleepy', duration: 4000 },
      wink: { class: 'eye-wink', duration: 1800 }
    };

    let currentEyeExpression = 'normal';
    let eyeTimer = null;

    // ========== æ•°æ®åˆå§‹åŒ–ï¼ˆå¸¦è‡ªåŠ¨æ¸…é™¤ï¼‰ ==========
    // å…ˆæ¸…é™¤æ—§æ•°æ®
    const wasCleared = clearOldData();
    
    // åˆå§‹åŒ–ç”¨æˆ·æ•°æ®
    let userData = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {
      totalClicks: 0,
      lastClickDate: null,
      achieved: [],
      cyclesCompleted: 0
    };
    
    // å¦‚æœæ˜¯è¢«æ¸…é™¤çš„æ•°æ®ï¼Œæ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯
    if (wasCleared) {
      userData = {
        totalClicks: 0,
        lastClickDate: null,
        achieved: [],
        cyclesCompleted: 0
      };
    }

    // ========== çœ¼ç›è¡¨æƒ…åŠŸèƒ½ ==========
    function setEyeExpression(expression) {
      if (!eyeLeft || !eyeRight) return;
      
      const baseClassesLeft = ['eye', 'eye-left'];
      const baseClassesRight = ['eye', 'eye-right'];
      
      eyeLeft.className = baseClassesLeft.join(' ');
      eyeRight.className = baseClassesRight.join(' ');
      
      currentEyeExpression = expression;
      const eyeConfig = eyeExpressions[expression];
      
      if (eyeConfig.class) {
        eyeLeft.classList.add(eyeConfig.class);
        eyeRight.classList.add(eyeConfig.class);
      }
      
      if (expression === 'wink') {
        eyeLeft.classList.remove('eye-wink');
      }
      
      if (eyeTimer) clearTimeout(eyeTimer);
      if (expression !== 'normal') {
        eyeTimer = setTimeout(() => setEyeExpression('normal'), eyeConfig.duration);
      }
    }

    function updateEyeExpression(clickCount, reactionText) {
      if (clickCount >= MAX_CLICKS) {
        setEyeExpression('love');
        return;
      }
      
      if (clickCount === 1) {
        setEyeExpression('surprised');
        return;
      }
      
      if (clickCount % 50 === 0) {
        setEyeExpression('happy');
        return;
      }
      
      if (clickCount === 7 || clickCount === 77 || clickCount === 777) {
        setEyeExpression('wink');
        return;
      }
      
      const text = reactionText.toLowerCase();
      if (text.includes('angry') || text.includes('mad') || text.includes('ğŸ˜ ')) {
        setEyeExpression('angry');
      } else if (text.includes('love') || text.includes('ğŸ’–') || text.includes('ğŸ¥°')) {
        setEyeExpression('love');
      } else if (text.includes('sleep') || text.includes('ğŸ˜´') || text.includes('tired')) {
        setEyeExpression('sleepy');
      } else if (text.includes('wow') || text.includes('surprise') || text.includes('ğŸ¤¯')) {
        setEyeExpression('surprised');
      } else if (text.includes('happy') || text.includes('joy') || text.includes('ğŸ˜„')) {
        setEyeExpression('happy');
      } else {
        if (Math.random() < 0.3) {
          const expressions = ['happy', 'surprised', 'wink', 'love'];
          const randomExp = expressions[Math.floor(Math.random() * expressions.length)];
          setEyeExpression(randomExp);
        }
      }
    }

    // ========== ç‚¹å‡»è®¡æ•°å™¨åŠŸèƒ½ ==========
    function updateClickCounter() {
      if (!clickCounter) return;
      
      const cycles = Math.floor(userData.totalClicks / MAX_CLICKS);
      const currentCycleClicks = userData.totalClicks % MAX_CLICKS || (userData.totalClicks === 0 ? 0 : MAX_CLICKS);
      
      if (cycles > 0) {
        clickCounter.textContent = `Cycle ${cycles + 1}: ${currentCycleClicks}/${MAX_CLICKS}`;
      } else {
        clickCounter.textContent = `Clicks: ${userData.totalClicks}`;
      }
      
      const specialCounts = [10, 25, 50, 69, 77, 88, 99, 100, 200, 300, 400, 500, 600, 700, 800, 900, 999];
      if (specialCounts.includes(currentCycleClicks)) {
        clickCounter.classList.add('highlight');
        setTimeout(() => clickCounter.classList.remove('highlight'), 500);
      }
      
      if (currentCycleClicks >= MAX_CLICKS - 100 && currentCycleClicks < MAX_CLICKS) {
        clickCounter.classList.add('maxed');
      } else {
        clickCounter.classList.remove('maxed');
      }
    }

    // ========== è¡¨æƒ…ç¬¦å·åŠŸèƒ½ ==========
    function getEmojiForClicks(clickCount) {
      const currentCycleClicks = clickCount % MAX_CLICKS || (clickCount === 0 ? 0 : MAX_CLICKS);
      
      const specialReaction = reactionConfig.specialEmojiReactions.find(r => r.count === currentCycleClicks);
      if (specialReaction) {
        return specialReaction.emoji;
      }
      
      for (const range of reactionConfig.emojiReactions) {
        if (currentCycleClicks >= range.minClicks && currentCycleClicks <= range.maxClicks) {
          const randomIndex = Math.floor(Math.random() * range.emojis.length);
          return range.emojis[randomIndex];
        }
      }
      
      return "âœ¨";
    }

    function showEmoji(emoji) {
      if (!emojiDisplay) return;
      
      emojiDisplay.textContent = emoji;
      emojiDisplay.style.display = 'block';
      
      const offset = (Math.random() * 40) - 20;
      emojiDisplay.style.left = `calc(50% + ${offset}px)`;
      
      const size = 30 + Math.random() * 20;
      emojiDisplay.style.fontSize = `${size}px`;
      
      setTimeout(() => {
        emojiDisplay.classList.add('show');
      }, 10);
      
      setTimeout(() => {
        emojiDisplay.classList.remove('show');
        setTimeout(() => {
          emojiDisplay.style.display = 'none';
        }, 1000);
      }, 1000);
    }

    // ========== æ•°æ®å­˜å‚¨åŠŸèƒ½ ==========
    function saveUserData() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(userData));
    }

    // ========== åé¦ˆæ˜¾ç¤ºåŠŸèƒ½ ==========
    function showReaction(text) {
      if (!feedbackBubble || !feedbackText) return;
      
      feedbackText.textContent = text;
      feedbackBubble.style.display = 'block';
      setTimeout(() => feedbackBubble.classList.add('show'), 10);

      setTimeout(() => {
        feedbackBubble.classList.remove('show');
        setTimeout(() => {
          if (!feedbackBubble.classList.contains('show')) {
            feedbackBubble.style.display = 'none';
          }
        }, 300);
      }, 3000);
    }

    // ========== ä¸»ååº”ç”Ÿæˆå‡½æ•° - ä¿®å¤ç‰ˆ ==========
    function generateReaction() {
      // å¢åŠ ç‚¹å‡»æ¬¡æ•°
      userData.totalClicks++;
      
      // æ£€æŸ¥æ˜¯å¦éœ€è¦é‡ç½®ï¼ˆåœ¨å¢åŠ åæ£€æŸ¥ï¼‰
      if (userData.totalClicks > MAX_CLICKS) {
        const cyclesCompleted = Math.floor(userData.totalClicks / MAX_CLICKS);
        userData.totalClicks = 1; // é‡ç½®ä¸º1ï¼ˆä¸æ˜¯0ï¼Œè¿™æ ·å°±æ˜¯æ–°å¾ªç¯çš„å¼€å§‹ï¼‰
        userData.cyclesCompleted = cyclesCompleted;
        
        // ä¿å­˜æ•°æ®
        saveUserData();
        
        // åº†ç¥é‡ç½®
        showEmoji("ğŸ”„");
        showReaction(`ğŸŠ Cycle ${cyclesCompleted} complete! Starting fresh! ğŸŒŸ`);
        updateClickCounter();
        setEyeExpression('love');
        
        return;
      }
      
      // æ›´æ–°æ˜¾ç¤º
      updateClickCounter();
      
      // æ˜¾ç¤ºè¡¨æƒ…
      const emoji = getEmojiForClicks(userData.totalClicks);
      showEmoji(emoji);
      
      const now = new Date();
      const currentHour = now.getHours();
      let finalReaction = '';

      // æ£€æŸ¥æˆå°±
      const currentCycleClicks = userData.totalClicks % MAX_CLICKS || userData.totalClicks;
      for (const ach of reactionConfig.achievementReactions) {
        if (currentCycleClicks === ach.count && !userData.achieved.includes(ach.id)) {
          userData.achieved.push(ach.id);
          finalReaction = `ğŸ‰ ${ach.text}`;
          saveUserData();
          showReaction(finalReaction);
          
          if (ach.count === 7) {
            setEyeExpression('wink');
          } else if (ach.count === 42) {
            setEyeExpression('surprised');
          } else if (ach.count === 100) {
            setEyeExpression('happy');
          } else if (ach.count === 500) {
            setEyeExpression('love');
          }
          return;
        }
      }

      // æ£€æŸ¥çŠ¶æ€ååº”
      const stateReaction = reactionConfig.stateReactions.find(r => r.state === currentCycleClicks);
      if (stateReaction) {
        finalReaction = stateReaction.text;
        saveUserData();
        showReaction(finalReaction);
        
        if (currentCycleClicks === 1) {
          setEyeExpression('surprised');
        } else if (currentCycleClicks === 5) {
          setEyeExpression('happy');
        } else if (currentCycleClicks === 10) {
          setEyeExpression('love');
        }
        return;
      }

      // æ£€æŸ¥æ—¶é—´ååº”
      const shouldCheckTime = currentCycleClicks === 1 || currentCycleClicks % 15 === 0;
      
      if (shouldCheckTime) {
        for (const timeR of reactionConfig.timeReactions) {
          if (timeR.start > timeR.end) {
            if (currentHour >= timeR.start || currentHour < timeR.end) {
              finalReaction = timeR.text;
              break;
            }
          } else if (currentHour >= timeR.start && currentHour < timeR.end) {
            finalReaction = timeR.text;
            break;
          }
        }
      }

      // éšæœºååº”
      if (!finalReaction) {
        const randomIndex = Math.floor(Math.random() * reactionConfig.randomReactions.length);
        finalReaction = reactionConfig.randomReactions[randomIndex];
        
        if (Math.random() < 0.3) {
          const expressions = ['happy', 'surprised', 'wink', 'love'];
          const randomExp = expressions[Math.floor(Math.random() * expressions.length)];
          setEyeExpression(randomExp);
        }
      }

      // ä¿å­˜å¹¶æ˜¾ç¤º
      userData.lastClickDate = now.toISOString();
      saveUserData();
      
      if (currentEyeExpression === 'normal') {
        updateEyeExpression(currentCycleClicks, finalReaction);
      }
      
      showReaction(finalReaction);
    }

    // ========== é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ– ==========
    document.addEventListener('DOMContentLoaded', function() {
      updateClickCounter();
      
      // æ˜¾ç¤ºæ¬¢è¿æ¶ˆæ¯ï¼ˆå¦‚æœæ˜¯æ–°å¼€å§‹æˆ–è¢«æ¸…é™¤ï¼‰
      if (wasCleared || userData.totalClicks === 0) {
        setTimeout(() => {
          showEmoji("ğŸ‘‹");
          showReaction("Welcome to the new and improved Elypo! Fresh start! ğŸ‰");
        }, 1000);
      } else if (userData.cyclesCompleted > 0) {
        setTimeout(() => {
          showEmoji("ğŸŠ");
          showReaction(`Welcome back! You've completed ${userData.cyclesCompleted} cycles! ğŸ†`);
        }, 1000);
      }
      
      // åˆå§‹åŒ–çœ¼ç›
      if (eyeLeft && eyeRight) {
        eyeLeft.className = 'eye eye-left';
        eyeRight.className = 'eye eye-right';
      }
      
      console.log(`Elypo v${APP_VERSION}: ${userData.totalClicks} clicks, ${userData.cyclesCompleted} cycles`);
    });

    // ========== äº‹ä»¶ç»‘å®š ==========
    if (mascot) {
      mascot.addEventListener('click', generateReaction);
      
      mascot.addEventListener('mouseenter', () => {
        if (currentEyeExpression === 'normal') {
          setEyeExpression('happy');
        }
      });
      
      mascot.addEventListener('mouseleave', () => {
        if (currentEyeExpression === 'happy') {
          setEyeExpression('normal');
        }
      });
    }

    // ========== ç­‰å¾…åˆ—è¡¨å¼¹çª—é€»è¾‘ ==========
    const tryElypoBtn = document.querySelector('.cta-btn');
    const waitlistModal = document.getElementById('waitlist-modal');
    const soulLabModal = document.getElementById('soul-lab-modal');
    const allCloseButtons = document.querySelectorAll('.close-modal');
    const waitlistForm = document.getElementById('waitlist-form');
    const soulLabForm = document.getElementById('soul-lab-form');


    if (tryElypoBtn) {
      tryElypoBtn.addEventListener('click', () => {
    // éšæœºå†³å®šå¼¹å‡ºå“ªä¸ªï¼ˆ0: ç­‰å¾…åˆ—è¡¨ï¼Œ 1: çµé­‚å®éªŒå®¤ï¼‰
      const showSoulLab = Math.random() > 0.4;
    if (showSoulLab) {
      soulLabModal.style.display = 'flex';
    } else {
      waitlistModal.style.display = 'flex';
    }
      });
    }

    // é€šç”¨å…³é—­å¼¹çª—å‡½æ•°
    function closeAllModals() {
      waitlistModal.style.display = 'none';
      soulLabModal.style.display = 'none';
    }

    // ä¸ºæ‰€æœ‰å…³é—­æŒ‰é’®ç»‘å®šäº‹ä»¶
    allCloseButtons.forEach(btn => {
      // é¿å…é‡å¤ç»‘å®šï¼Œå…ˆæ£€æŸ¥
      if (!btn.hasAttribute('data-close-bound')) {
        btn.setAttribute('data-close-bound', 'true');
        btn.addEventListener('click', closeAllModals);
      }
    });

    // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
    window.addEventListener('click', (e) => {
      if (e.target === waitlistModal || e.target === soulLabModal) {
        closeAllModals();
      }
    });

    if (closeModal && waitlistModal) {
      closeModal.addEventListener('click', () => waitlistModal.style.display = 'none');
    }

    if (waitlistModal) {
      window.addEventListener('click', (e) => { 
        if (e.target === waitlistModal) waitlistModal.style.display = 'none'; 
      });
    }

    if (waitlistForm) {
      waitlistForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = this.querySelector('input[type="email"]').value;
        if (email) {
          alert(`Thanks, ${email}! You're on the list. We'll be in touch.`);
          this.reset();
          if (waitlistModal) waitlistModal.style.display = 'none';
        }
      });
    }

    // ===== æ–°å¢ï¼šçµé­‚å®éªŒå®¤è¡¨å•æäº¤å¤„ç† =====
    if (soulLabForm) {
      soulLabForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('soul-lab-email').value;
        if (email) {
          // è¿™é‡Œæ›¿æ¢ä¸ºä½ çš„å®é™…å¤„ç†é€»è¾‘ï¼Œä¾‹å¦‚å‘é€åˆ°åç«¯æˆ–è®°å½•åˆ°è¡¨æ ¼
          console.log(`Soul Lab å®éªŒæŠ¥åé‚®ç®±: ${email}`);
          alert(`Thank you! Your interest in the Soul Resonance Lab has been registered. We will contact you with details soon.`);
          this.reset();
          closeAllModals(); // ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„é€šç”¨å…³é—­å‡½æ•°
        }
      });
    }
    
    // ========== æ‰‹åŠ¨é‡ç½®æŒ‰é’®ï¼ˆè°ƒè¯•ç”¨ï¼‰ ==========
    // åœ¨æ§åˆ¶å°è¾“å…¥ï¼šwindow.resetElypo() å¯ä»¥æ‰‹åŠ¨é‡ç½®
    window.resetElypo = function() {
      localStorage.clear();
      location.reload();
    };
    
    // åœ¨æ§åˆ¶å°è¾“å…¥ï¼šwindow.setClicks(500) å¯ä»¥è®¾ç½®ç‚¹å‡»æ¬¡æ•°
    window.setClicks = function(count) {
      userData.totalClicks = count;
      saveUserData();
      updateClickCounter();
      console.log(`Set clicks to ${count}`);
    };
  </script>
</body>
</html>